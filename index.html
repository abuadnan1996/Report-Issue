<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Report</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Plant Reports</h1>
        <h4>Instrument and Control Department</h4>
         <div class="table-container">
            <table id="reportTable">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Plant Name</th>
                    <th>Report by</th>
                    <th>Shift</th>
                    <th>Priority</th>
                    <th>Tag</th>
                    <th>Report</th>
                    <th>Status</th>
                </tr>
            </thead> 
            <tbody>
                <!-- Specific data will be populated here -->
            </tbody>
        </table>
        </div>
        <footer>
            <p>Developer: Abu Adnan, Engineer, Instrument and Control </p>
            <p> <a href="mailto:abuadnan1996@gmail.com">abuadnan1996@gmail.com</a> </p>
        </footer>
    </div>

    <script>
        // Replace 'YOUR_SHEET_ID' with your actual Google Sheet ID
        const sheetID = '1uS2vd1GhfHRHqBGE8yb9-GgkBO2mimPuYV3gYOQ2LK0';  // E.g., '1A2B3C4D5E6F7G8H9I0J'
        const gid = '0'; // Change this if your data is on another sheet (find gid in URL)
        const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&gid=${gid}`;

        // Fetch data from Google Sheets
              fetch(url)
                .then(response => response.text())
                .then(data => {
                // Parse the JSON response
                const json = JSON.parse(data.substr(47).slice(0, -2)); // Clean up the response string
                const rows = json.table.rows;

                // Get the table body element
                const tableBody = document.getElementById('reportTable').getElementsByTagName('tbody')[0];

                // Clear any existing rows
                tableBody.innerHTML = '';

                // Iterate over each row of data
                rows.forEach(row => {
                    // Create a new row for each set of data
                    const newRow = tableBody.insertRow();
                    
                    // Fetch cells from B to G (indices 1 to 6)
                    for (let i = 0; i <= 7; i++) { // Indices 1 to 6 correspond to columns B to G
                        const newCell = newRow.insertCell(); // Create a new cell
                        newCell.textContent = row.c[i] ? row.c[i].v : ''; // Set cell content, handle empty cells
                    }
                });
            })

            .catch(error => console.error('Error fetching the Google Sheet data:', error));
    </script>
</body>
</html>
